
<main>
  <!-- Overview -->
  <section class="overview">
    <div class="grid">
      <div class="grid-cell">
        <h2>Overview</h2>
        <ul class="toggle" [ngStyle]="hideElement(!userLoggedIn())">
          <li id="toggle-your-overview" class="{{!isMarketOverviewActive() ? 'active': ''}}" (click)="onToggleYourOverviewClick()">Your overview</li>
          <li id="toggle-market-overview" class="{{isMarketOverviewActive() ? 'active': ''}}" (click)="onToggleMarketOverviewClick()">Market overview</li>
        </ul>
      </div>

      <div class="grid-cell">
        <label id="apr-toggle">
          <input id="apr-toggle-checkbox" type="checkbox" [(ngModel)]="ommApyChecked" (change)="ommApyToggleChanged()">
          <span class="switch-slider round"></span>
        </label>
        <p class="label apr-label" #aprLabel>{{ommApyChecked ? "APY with OMM" : "APY without OMM"}} {{getOmmPriceUSD()}}</p>
      </div>
    </div>

        <!-- Your overview content -->
        <div id="your-overview-content" class="grid panel" [ngStyle]="hideElement(isMarketOverviewActive() || !userLoggedIn())">
          <!-- Supplied -->
          <div class="grid-cell border-right">
            <div class="grid">
              <!-- You've supplied -->
              <div class="grid-cell text-center">
                <dl class="metadata">
                  <dt>You've supplied</dt>
                  <dd class="value-supplied-total">{{this.toDollarUSLocaleString(roundOffTo2Decimals(this.persistenceService.getUserTotalSuppliedUSD()))}}</dd>
                </dl>
              </div>

          <!-- Your supply APY -->
          <div class="grid-cell text-center">
            <dl class="metadata">
              <dt class="">Your supply APY</dt>
              <dd class="text-green value-supplied-apy">{{to2DecimalRoundedOffPercentString(this.calculationService.getYourSupplyApy(ommApyChecked))}}</dd>
            </dl>
          </div>
        </div>
      </div>

      <!-- Borrowed -->
      <div class="grid-cell">
        <div class="grid">
          <!-- You've borrowed -->
          <div class="grid-cell text-center">
            <dl class="metadata">
              <dt>You've borrowed</dt>
              <dd class="value-borrowed-total">{{this.toDollarUSLocaleString(roundOffTo2Decimals(this.persistenceService.getUserTotalBorrowedUSD()))}}</dd>
            </dl>
          </div>

          <!-- Your borrow APY -->
          <div class="grid-cell text-center">
            <dl class="metadata">
              <dt>Your borrow APY</dt>
              <dd class="text-purple value-borrowed-apy">{{to2DecimalRoundedOffPercentString(this.calculationService.getYourBorrowApy(ommApyChecked))}}</dd>
            </dl>
          </div>
        </div>
      </div>
    </div>

        <!-- Market overview content -->
        <div id="market-overview-content" class="grid panel" [ngStyle]="hideElement(!isMarketOverviewActive())">
          <!-- Supplied -->
          <div class="grid-cell border-right">
            <div class="grid">
              <!-- Total supplied -->
              <div class="grid-cell text-center">
                <dl class="metadata">
                  <dt>Total supplied</dt>
                  <dd>{{this.toDollarUSLocaleString(roundOffTo2Decimals(this.persistenceService.getTotalSuppliedUSD()))}}</dd>
                </dl>
              </div>

              <!-- Total supply APY -->
              <div class="grid-cell text-center">
                <dl class="metadata">
                  <dt>Total supply APY</dt>
                  <dd class="text-green">{{to2DecimalRoundedOffPercentString(this.calculationService.getTotalAvgSupplyApy(ommApyChecked))}}</dd>
                </dl>
              </div>
            </div>
          </div>

          <!-- Borrowed -->
          <div class="grid-cell">
            <div class="grid">
              <!-- Total borrowed -->
              <div class="grid-cell text-center">
                <dl class="metadata">
                  <dt>Total borrowed</dt>
                  <dd>{{this.toDollarUSLocaleString(roundOffTo2Decimals(this.persistenceService.getTotalBorrowedUSD()))}}</dd>
                </dl>
              </div>

              <!-- Total borrow APY -->
              <div class="grid-cell text-center">
                <dl class="metadata">
                  <dt>Total borrow APY</dt>
                  <dd class="text-purple">{{to2DecimalRoundedOffPercentString(this.calculationService.getTotalAvgBorrowApy(ommApyChecked))}}</dd>
                </dl>
              </div>
            </div>
          </div>
        </div>
      </section>

  <!-- Performance / Risk , hide if user not logged in or he has not supplied any asset-user -->
  <div class="grid side-by-side performance-risk" [ngStyle]="hideElement(!userLoggedIn()
                                                             || this.persistenceService.userHasNotSuppliedAnyAsset())">
    <!-- Performance -->
    <div class="grid-cell">
      <section id="performance">
        <app-performance style="display: contents"></app-performance>
      </section>
    </div>

    <!-- Risk -->
    <div class="grid-cell">
      <section id="risk">
        <app-risk style="display: contents" [userAssetComponents]="assetComponents"></app-risk>
      </section>
    </div>
  </div>

  <!-- Markets -->
  <section id="markets">
    <div class="grid grid-center filters">
      <div class="grid-cell">
        <h2>Markets</h2>
        <ul class="toggle" [ngStyle]="hideElement(!userLoggedIn())">
          <li id="toggle-your-markets" class="{{userMarketViewActive() ? 'active': ''}}" (click)="onYourMarketsClick()">Your markets</li>
          <li id="toggle-all-markets"  class="{{allMarketViewActive() ? 'active': ''}}" (click)="onAllMarketsClick()">All markets</li>
        </ul>
      </div>
    </div>

    <!-- Markets list -->
    <div class="grid">
      <div class="grid-cell">
        <table class="list markets">
          <thead>
            <tr id="your-markets-header" [ngStyle]="hideElement(shouldHideYourMarketHeader())">
              <th>Asset</th>
              <th>You've supplied</th>
              <th>Supply APY <span class="supply-apy-tooltip tooltip">
													<span class="tooltip-item"><img src="assets/img/icon/question.svg" class="tooltip-icon"></span>
													<div class="tooltip-content"><p class="supply-apy-tooltip-content">{{
                            ommApyChecked ? "The amount you’ll earn from interest and OMM if you supply an asset for 1 year. Rates vary based on supply and demand.":
                              "The amount of interest you’ll earn if you supply an asset for 1 year. Rates vary based on supply and demand."
                            }}</p></div>
												</span></th>
              <th>You've borrowed</th>
              <th>Borrow APY <span class="borrow-apy-tooltip tooltip">
													<span class="tooltip-item"><img src="assets/img/icon/question.svg" class="tooltip-icon"></span>
													<div class="tooltip-content"><p class="borrow-apy-tooltip-content">{{
                            ommApyChecked ? "The amount you’ll owe from interest, minus the OMM you’ll earn, if you supply an asset for 1 year. Rates vary based on supply and demand.":
                              "The amount of interest you’ll owe if you borrow an asset for 1 year. Rates vary based on supply and demand."
                            }}</p></div>
												</span></th>
            </tr>

            <tr id="all-markets-header" [ngStyle]="hideElement(!allMarketViewActive())">
              <th>Asset</th>
              <th>Total supplied</th>
              <th>Supply APY <span class="supply-apy-tooltip tooltip">
													<span class="tooltip-item"><img src="assets/img/icon/question.svg" class="tooltip-icon"></span>
													<div class="tooltip-content"><p class="supply-apy-tooltip-content">{{
                            ommApyChecked ? "The amount you’ll earn from interest and OMM if you supply an asset for 1 year. Rates vary based on supply and demand.":
                              "The amount of interest you’ll earn if you supply an asset for 1 year. Rates vary based on supply and demand."
                            }}</p></div>
												</span></th>
              <th>Total borrowed</th>
              <th>Borrow APY <span class="borrow-apy-tooltip tooltip">
													<span class="tooltip-item"><img src="assets/img/icon/question.svg" class="tooltip-icon"></span>
													<div class="tooltip-content"><p class="borrow-apy-tooltip-content">{{
                            ommApyChecked ? "The amount you’ll owe from interest, minus the OMM you’ll earn, if you supply an asset for 1 year. Rates vary based on supply and demand.":
                              "The amount of interest you’ll owe if you borrow an asset for 1 year. Rates vary based on supply and demand."
                            }}</p></div>
												</span></th>
            </tr>
          </thead>
          <tbody>

          <!-- Assets -->
          <ng-container>
            <ng-container *ngFor="let asset of userAssets; last as isLast; let i = index">
              <!-- Asset (USDb, ICX, ..) -->
              <app-asset [asset]="asset" #assetEl
                         [ommApyChecked]="ommApyChecked"
                         [riskSlider]="riskComponent.sliderRisk"
                         [index]="i"
                         [activeMarketView]="activeMarketView"
                         [ngStyle]="{display: 'contents'}"
                         (collOtherAssetTables)="collapseOtherAssetsTable($event)"
                              >
              </app-asset>
              <!-- Spacer -->
              <tr *ngIf="!isLast || availableAssets.length > 0" class="spacer"></tr>
            </ng-container>
          </ng-container>

          <!-- User available Assets (hide if user market view is not active) -->
          <ng-container *ngIf="userMarketViewActive() && availableAssets.length > 0">

            <!-- Available to supply -->
            <tr class="available-to-supply" #availSplitter>
              <td colspan="5">
                <div class="grid">
                  <div class="grid-cell">
                    <p class="separator-full text-center"><span>Available to supply</span></p>
                  </div>
                </div>
              </td>
            </tr>

                <ng-container *ngFor="let asset of availableAssets; last as isLast; let i = index">
                  <!-- Asset (USDb, ICX, ..) -->
                  <app-asset [asset]="asset" #availAsset
                             [ommApyChecked]="ommApyChecked"
                             [index]="i"
                             [ngStyle]="hideElementOrDisplayContents(!userMarketViewActive())"
                             (collOtherAssetTables)="collapseOtherAssetsTable($event)"
                                  >
                  </app-asset>
                  <!-- Spacer -->
                  <tr *ngIf="!isLast" class="spacer"></tr>
                </ng-container>
              </ng-container>

          </tbody>
        </table>

        <!-- If no assets available message bridge wallet -->
        <div id="message-no-asset-bridge" class="grid"
             [ngStyle]="hideElement(allMarketViewActive() || !userLoggedIn() || !noActiveOrAvailableAsset())">
          <div class="grid-cell">
            <p class="label text-center">You have no assets available to supply.</p>
            <p *ngIf="persistenceService.bridgeWalletActive()" class="text-center" style="margin-top: 15px;"><a href="javascript:void(0);" class="button" (click)="onDepositUSDClick()">Deposit USD</a></p>
          </div>
        </div>

      </div>
    </div>
  </section>

</main>

